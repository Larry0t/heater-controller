[
  {
    "id": "f1_controller",
    "type": "function",
    "z": "flow1",
    "name": "Heater Controller",
    "func": "// Paste the latest Function Node code here (with runtime config support)\n",
    "outputs": 4,
    "noerr": 0,
    "initialize": "",
    "finalize": "",
    "libs": []
  },
  {
    "id": "victron_batt_power",
    "type": "victron-input",
    "z": "flow1",
    "name": "Battery Power",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Battery/Power",
    "x": 120,
    "y": 80,
    "wires": [["f1_controller"]]
  },
  {
    "id": "victron_batt_soc",
    "type": "victron-input",
    "z": "flow1",
    "name": "Battery SOC",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Battery/Soc",
    "x": 120,
    "y": 120,
    "wires": [["f1_controller"]]
  },
  {
    "id": "victron_l1",
    "type": "victron-input",
    "z": "flow1",
    "name": "Load L1",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Ac/Out/L1/P",
    "x": 120,
    "y": 160,
    "wires": [["f1_controller"]]
  },
  {
    "id": "victron_l2",
    "type": "victron-input",
    "z": "flow1",
    "name": "Load L2",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Ac/Out/L2/P",
    "x": 120,
    "y": 200,
    "wires": [["f1_controller"]]
  },
  {
    "id": "victron_l3",
    "type": "victron-input",
    "z": "flow1",
    "name": "Load L3",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Ac/Out/L3/P",
    "x": 120,
    "y": 240,
    "wires": [["f1_controller"]]
  },
  {
    "id": "victron_boiler_temp",
    "type": "victron-input",
    "z": "flow1",
    "name": "Boiler Temperature",
    "service": "com.victronenergy.temperature",
    "path": "/Boiler/Temp",
    "x": 140,
    "y": 280,
    "wires": [["f1_controller"]]
  },
  {
    "id": "victron_inverter_load",
    "type": "victron-input",
    "z": "flow1",
    "name": "Inverter Load",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Ac/Out/P",
    "x": 140,
    "y": 320,
    "wires": [["f1_controller"]]
  },
  {
    "id": "sun_times",
    "type": "victron-input",
    "z": "flow1",
    "name": "Sunrise/Sunset",
    "service": "com.victronenergy.system",
    "path": "/Time/Sun",
    "x": 140,
    "y": 360,
    "wires": [["f1_controller"]]
  },
  {
    "id": "relay0",
    "type": "victron-output",
    "z": "flow1",
    "name": "Relay L1",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Relay/0/State",
    "x": 700,
    "y": 80,
    "wires": []
  },
  {
    "id": "relay1",
    "type": "victron-output",
    "z": "flow1",
    "name": "Relay L2",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Relay/1/State",
    "x": 700,
    "y": 120,
    "wires": []
  },
  {
    "id": "relay2",
    "type": "victron-output",
    "z": "flow1",
    "name": "Relay L3",
    "service": "com.victronenergy.vebus.ttyO1",
    "path": "/Relay/2/State",
    "x": 700,
    "y": 160,
    "wires": []
  },
  {
    "id": "status_debug",
    "type": "debug",
    "z": "flow1",
    "name": "Heater Status",
    "active": true,
    "tosidebar": true,
    "console": false,
    "tostatus": false,
    "complete": "true",
    "x": 700,
    "y": 220,
    "wires": []
  },
  {
    "id": "config_ui",
    "type": "ui_form",
    "z": "flow1",
    "name": "Heater Config",
    "label": "Update Config",
    "group": "config_group",
    "order": 1,
    "width": 0,
    "height": 0,
    "options": [
      {"label":"On Threshold (W)","value":"onThreshold","type":"number"},
      {"label":"Off Threshold (W)","value":"offThreshold","type":"number"},
      {"label":"Min SOC (%)","value":"minSoc","type":"number"},
      {"label":"Boiler Temp Max (Â°C)","value":"boilerTempMax","type":"number"},
      {"label":"Inverter Load Max (W)","value":"inverterLoadMax","type":"number"}
    ],
    "x": 140,
    "y": 420,
    "wires": [["config_topic"]]
  },
  {
    "id": "config_topic",
    "type": "change",
    "z": "flow1",
    "name": "Set /Heater/Config",
    "rules": [
      {
        "t": "set",
        "p": "topic",
        "pt": "msg",
        "to": "/Heater/Config",
        "tot": "str"
      }
    ],
    "x": 370,
    "y": 420,
    "wires": [["f1_controller"]]
  },
  {
    "id": "config_group",
    "type": "ui_group",
    "name": "Heater Settings",
    "tab": "config_tab",
    "order": 1,
    "disp": true,
    "width": "6",
    "collapse": false
  },
  {
    "id": "config_tab",
    "type": "ui_tab",
    "name": "Heater Control",
    "icon": "settings",
    "order": 1
  }
]